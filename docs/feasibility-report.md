# OCRCheck 可行性調査報告書

## 書類スキャン・OCR・AI管理システム POC

**作成日**: 2026年2月9日
**プロジェクト名**: OCRCheck
**ステータス**: POC検討段階

---

## 1. プロジェクト概要

### 1.1 背景
大量の事務書類をスキャンし、OCRやAIを使って読み取り・データ化・管理する処理システムの開発を検討。書類には多様なフォーマット（テキスト、表、写真添付など）が混在しており、統一的なデジタル管理基盤が求められている。

### 1.2 要件概要

| # | 要件 | 概要 |
|---|------|------|
| ① | 書類スキャン・格納 | スキャンした書類をS3等のクラウドストレージに格納 |
| ② | OCR・AIによるデータ化 | 各書類をOCR/AIで読み取り、可能な範囲で情報化 |
| ③ | 検索・分類 | 読み取った情報で書類を検索・分類できる仕組み |
| ④ | 修正・コメント・共有 | OCR結果の手動修正、コメント追加、URL共有、協働編集 |

---

## 2. 技術調査: OCRモデルの精度比較

### 2.1 クラウドOCRサービス比較

| サービス | テキスト精度 | 日本語対応 | 表抽出 | 手書き | 価格 (1,000ページ) |
|---------|------------|-----------|--------|--------|------------------|
| **Google Cloud Vision** | ~98% | ◎ 優秀 | ○ 良好 | ○ | $1.50 |
| **Azure Document Intelligence** | ~99.8% (活字) | ○ 対応 | ◎ 最良 | △ | $1.50 |
| **AWS Textract** | ~97-98% | ○ 対応 | ○ 良好 | ○ | $1.50 (基本) |

### 2.2 オープンソースOCRエンジン比較

| エンジン | 精度 | 日本語対応 | 表抽出 | 特徴 |
|---------|------|-----------|--------|------|
| **PaddleOCR PP-OCRv5** | ◎ 96.58% | ◎ 最良 | ○ | 日本語に特化した最適化、縦書き対応 |
| **Surya** | ◎ 97.70% | ○ 対応 | ○ | 90+言語、高速処理 |
| **MinerU2.5** | ◎ SOTA | ○ 対応 | ◎ 最良 | 表抽出に特化、1.2Bパラメータ |
| **Tesseract** | △ | △ 基本的 | × | 単純文書向け、複雑レイアウトに弱い |
| **EasyOCR** | ○ | ○ 対応 | △ | プロトタイプ向け |

### 2.3 Vision LLM (文書理解)

| モデル | OCR精度 | 文書理解 | 日本語 | コスト |
|--------|---------|---------|--------|-------|
| **Gemini 2.5 Pro / 3 Pro** | ◎ | ◎ 最良 | ◎ | 中 |
| **Claude Opus 4.5 / Sonnet 4.5** | ◎ | ◎ | ◎ | 中〜高 |
| **GPT-4o / GPT-5** | ○ | ◎ | ◎ | 高 |
| **MiniCPM-o 2.6** (OSS) | ◎ OCRBench1位 | ○ | ○ | 無料 (自己ホスト) |

### 2.4 推奨構成

**ハイブリッドパイプライン方式を推奨**:

```
専用OCRエンジン (文字認識精度重視)
  + Vision LLM (文書理解・構造化・分類)
```

| 役割 | 推奨技術 | 理由 |
|------|---------|------|
| テキストOCR | **PaddleOCR PP-OCRv5** | 日本語最適化、縦書き対応、OSS無料 |
| 表抽出 | **MinerU2.5** | テーブル抽出SOTA、OSS |
| レイアウト解析 | **PP-DocLayout** | PaddleOCRと統合、高精度 |
| 文書理解・分類 | **Claude Vision** or **Gemini Pro** | 文脈理解、構造化出力に優れる |
| 全文検索 | **Elasticsearch (OpenSearch)** | 日本語形態素解析対応 |

---

## 3. システムアーキテクチャ

### 3.1 全体構成

```
[ユーザー] → [Web App (Next.js)] → [API (FastAPI)] → [AWS Infrastructure]
                                         │
                    ┌────────────────────┼────────────────────┐
                    ▼                    ▼                    ▼
              [S3 Storage]      [Processing Pipeline]   [PostgreSQL]
                                     │
                    ┌────────────────┼────────────────┐
                    ▼                ▼                ▼
              [PaddleOCR]      [MinerU2.5]     [Vision LLM]
                    │                │                │
                    └────────────────┼────────────────┘
                                     ▼
                              [Elasticsearch]
                              (全文検索インデックス)
```

### 3.2 コンポーネント一覧

| レイヤー | コンポーネント | 技術 |
|---------|--------------|------|
| フロントエンド | Webアプリ | Next.js 15 + TypeScript |
| フロントエンド | ドキュメントビューア | PDF.js + Canvas |
| フロントエンド | 注釈・コメント | Collaborative annotation (WebSocket) |
| バックエンド | REST API | FastAPI (Python) |
| バックエンド | 認証 | AWS Cognito / NextAuth.js |
| バックエンド | リアルタイム通信 | WebSocket (FastAPI) |
| 処理パイプライン | ジョブキュー | Redis (ElastiCache) / SQS |
| 処理パイプライン | OCR処理 | PaddleOCR PP-OCRv5 |
| 処理パイプライン | 表抽出 | MinerU2.5 |
| 処理パイプライン | レイアウト解析 | PP-DocLayout |
| 処理パイプライン | AI文書理解 | Claude API / Gemini API |
| データストア | ファイルストレージ | Amazon S3 |
| データストア | メタデータDB | PostgreSQL (RDS) |
| データストア | 全文検索 | OpenSearch (Elasticsearch互換) |
| データストア | キャッシュ | Redis (ElastiCache) |
| インフラ | コンテナ実行 | ECS Fargate |
| インフラ | GPU処理 | ECS Fargate (GPU) / SageMaker |
| インフラ | CDN | CloudFront |
| インフラ | 監視 | CloudWatch |

### 3.3 PlantUML図

以下のPlantUML図を生成済み：
- `docs/architecture.puml` — システム全体アーキテクチャ図
- `docs/processing-pipeline.puml` — OCR処理パイプライン詳細フロー
- `docs/deployment.puml` — AWSデプロイメント構成図

---

## 4. 各要件の実現方法

### 4.1 ① 書類スキャン・格納

| 項目 | 内容 |
|------|------|
| 実現方法 | S3バケットへの直接アップロード (Webアプリ経由) |
| 対応フォーマット | PDF, TIFF, JPEG, PNG, BMP |
| ストレージ設計 | `s3://ocrcheck/{tenant_id}/{year}/{month}/{document_id}/original.*` |
| 自動処理トリガー | S3イベント → Lambda → SQSジョブキュー |
| 追加機能 | バッチアップロード、ドラッグ&ドロップ、フォルダ監視 |
| 開発難易度 | ★☆☆☆☆ (低) |

### 4.2 ② OCR・AIによるデータ化

| 項目 | 内容 |
|------|------|
| 実現方法 | ハイブリッドパイプライン (PaddleOCR + MinerU + Vision LLM) |
| 処理フロー | レイアウト解析 → 領域別OCR → AI統合理解 → 構造化 |
| 日本語精度 (活字) | 期待精度: 95-99% (文書品質による) |
| 日本語精度 (手書き) | 期待精度: 70-85% (要実測検証) |
| 表抽出精度 | 期待精度: 90-97% (MinerU2.5使用) |
| 処理時間目安 | 1ページあたり 3-10秒 (GPU使用時) |
| 開発難易度 | ★★★★☆ (高) — パイプラインの最適化が鍵 |

### 4.3 ③ 検索・分類

| 項目 | 内容 |
|------|------|
| 全文検索 | OpenSearch + 日本語形態素解析 (kuromoji) |
| 分類方法 | Vision LLMによる自動分類 + ルールベース補完 |
| 分類カテゴリ例 | 契約書、請求書、報告書、通知書、申請書、その他 |
| 検索機能 | キーワード検索、日付範囲、分類フィルタ、タグ |
| 類似文書検索 | ベクトル検索 (文書埋め込み) による類似検索 |
| 開発難易度 | ★★★☆☆ (中) |

### 4.4 ④ 修正・コメント・共有

| 項目 | 内容 |
|------|------|
| OCR修正UI | インライン編集 (文書画像上にオーバーレイ) |
| コメント機能 | 領域選択 + コメント追加 (Google Docs風) |
| 共有機能 | URL共有 (公開/限定公開/パスワード付き) |
| 協働編集 | WebSocketによるリアルタイム同期 |
| 変更履歴 | 修正履歴の保持・差分表示 |
| 権限管理 | ロールベース (管理者/編集者/閲覧者) |
| 開発難易度 | ★★★★☆ (高) — リアルタイム協働が複雑 |

---

## 5. POC実施計画

### 5.1 POCスコープ

POCでは以下の最小限の機能セットを実装し、技術的実現可能性を検証する：

| Phase | 内容 | 期間目安 |
|-------|------|---------|
| **Phase 1** | 環境構築 + ファイルアップロード + S3格納 | 1週間 |
| **Phase 2** | OCRパイプライン (PaddleOCR + MinerU) | 2週間 |
| **Phase 3** | AI文書理解・分類 (Claude/Gemini連携) | 1週間 |
| **Phase 4** | 検索UI + 全文検索 (OpenSearch) | 1週間 |
| **Phase 5** | 修正・コメント・共有UI | 2週間 |
| **Phase 6** | 結合テスト・精度検証・デモ準備 | 1週間 |

**POC合計期間目安: 約8週間**

### 5.2 POC技術スタック

```
フロントエンド:  Next.js 15 + TypeScript + Tailwind CSS
バックエンド:    FastAPI (Python 3.12)
OCRエンジン:    PaddleOCR PP-OCRv5
表抽出:         MinerU2.5
AI理解:         Claude API (Anthropic) / Gemini API (Google)
データベース:    PostgreSQL 16
検索エンジン:    OpenSearch 2.x
キャッシュ:      Redis 7
ストレージ:      Amazon S3
コンテナ:       Docker + Docker Compose (ローカル開発)
```

### 5.3 POCで検証すべき項目

| # | 検証項目 | 判定基準 |
|---|---------|---------|
| 1 | 日本語OCR精度 (活字) | 95%以上の文字認識精度 |
| 2 | 日本語OCR精度 (手書き) | 70%以上 (参考値) |
| 3 | 表抽出精度 | 90%以上のセル認識精度 |
| 4 | 処理速度 | 1ページあたり10秒以内 |
| 5 | 自動分類精度 | 80%以上の正分類率 |
| 6 | 全文検索の適合率 | 検索結果上位10件の適合率80%以上 |
| 7 | システム安定性 | 100ページ連続処理でエラーなし |

---

## 6. コスト概算

### 6.1 POCフェーズ (月額)

| 項目 | サービス | 月額概算 |
|------|---------|---------|
| コンピュート | ECS Fargate (2vCPU, 4GB) x 2 | ~$150 |
| GPU処理 | ECS Fargate GPU (推論時のみ) | ~$200 |
| ストレージ | S3 (100GB) | ~$3 |
| DB | RDS PostgreSQL (db.t3.medium) | ~$70 |
| 検索 | OpenSearch (t3.small.search) | ~$50 |
| キャッシュ | ElastiCache Redis (t3.micro) | ~$15 |
| AI API | Claude API / Gemini API (1000ページ/月) | ~$50-100 |
| その他 | ALB, CloudWatch, データ転送 | ~$50 |
| **合計** | | **~$590-640/月** |

### 6.2 本番運用フェーズ (月額概算)

月間処理量10,000ページの場合：

| 項目 | 月額概算 |
|------|---------|
| コンピュート (スケールアップ) | ~$500 |
| GPU処理 | ~$800 |
| ストレージ (1TB) | ~$25 |
| DB (db.r6g.large) | ~$250 |
| OpenSearch (m6g.large.search) | ~$200 |
| AI API (10,000ページ) | ~$500-1,000 |
| その他 | ~$200 |
| **合計** | **~$2,475-2,975/月** |

---

## 7. リスクと対策

| # | リスク | 影響度 | 対策 |
|---|--------|-------|------|
| 1 | 日本語OCR精度が期待を下回る | 高 | POCで実文書で検証。複数エンジン併用で補完 |
| 2 | 手書き文字の認識精度が低い | 中 | スコープを活字優先に。手書きは将来対応 |
| 3 | 多様なフォーマットへの対応 | 中 | レイアウト解析を充実させ、フォーマット別処理 |
| 4 | GPU処理コストの増大 | 中 | SageMaker Serverless推論、バッチ処理で最適化 |
| 5 | AI APIコストの増大 | 中 | ルールベース分類を併用し、API呼出を最適化 |
| 6 | リアルタイム協働編集の複雑さ | 低 | POCではシンプルな編集に留め、本番で段階的に拡張 |

---

## 8. 結論・推奨

### 8.1 技術的実現可能性: **高い**

- OCR技術（特にPaddleOCR PP-OCRv5）は日本語文書に対して十分な精度を持つ
- Vision LLM（Claude / Gemini）による文書理解・構造化は実用レベルに達している
- オープンソースの組み合わせにより、コストを抑えつつ高機能なシステム構築が可能

### 8.2 推奨アプローチ

1. **オープンソース中心のハイブリッド構成** — PaddleOCR + MinerU (OSS) + Claude/Gemini API (文書理解)
2. **段階的な開発** — POCで精度検証 → MVPで基本機能実装 → 本番で拡張
3. **クラウドネイティブ** — AWS上でコンテナベースのスケーラブルな構成
4. **実文書での早期検証** — 顧客の実際の書類サンプルを使ったPOCが最重要

### 8.3 開発可能範囲

| 要件 | 開発可否 | 備考 |
|------|---------|------|
| ① S3環境構築・ファイル格納 | ✅ 開発可能 | AWS CDK/Terraformで構築 |
| ② OCR・AIデータ化 | ✅ 開発可能 | OSS + API組合せで実現 |
| ③ 検索・分類 | ✅ 開発可能 | OpenSearch + AI分類 |
| ④ 修正・コメント・共有 | ✅ 開発可能 | Webアプリとして実装 |

**全ての要件について開発可能と判断する。POCにて技術的な精度検証を行い、本番開発への移行判断を行うことを推奨する。**

---

## 付録: 参考技術・ツール

| カテゴリ | 名称 | URL/備考 |
|---------|------|---------|
| OCR | PaddleOCR PP-OCRv5 | https://github.com/PaddlePaddle/PaddleOCR |
| 表抽出 | MinerU2.5 | https://github.com/opendatalab/MinerU |
| レイアウト解析 | PP-DocLayout | PaddleOCRに統合 |
| AI文書理解 | Claude API | https://docs.anthropic.com/ |
| AI文書理解 | Gemini API | https://ai.google.dev/ |
| 全文検索 | OpenSearch | https://opensearch.org/ |
| フロントエンド | Next.js | https://nextjs.org/ |
| バックエンド | FastAPI | https://fastapi.tiangolo.com/ |
| PDFビューア | PDF.js | https://mozilla.github.io/pdf.js/ |
| コンテナ | Docker | https://docker.com/ |
| IaC | AWS CDK | https://aws.amazon.com/cdk/ |
